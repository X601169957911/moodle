{"version":3,"sources":["../src/clipboardwrapper.js"],"names":["init","copied","copy","copytoclipboard","btnHtml","document","querySelectorAll","selectors","clipboardcontent","forEach","element","insertAdjacentHTML","clipboardbutton","btn","tooltipBtn","Tooltip","addEventListener","hide","clClipboard","Clipboard","target","trigger","parentNode","nextElementSibling","on","e","setAttribute","show","setTimeout","dispose","clearSelection"],"mappings":"4QAwBA,OACA,OAEA,O,kXAKO,GAAMA,CAAAA,CAAI,4CAAG,2HACK,iBAAU,QAAV,CAAoB,uBAApB,CADL,QACVC,CADU,uBAEG,iBAAU,MAAV,CAAkB,uBAAlB,CAFH,QAEVC,CAFU,uBAGc,iBAAU,iBAAV,CAA6B,uBAA7B,CAHd,QAGVC,CAHU,QAKVC,CALU,yGAMyCD,CANzC,eAM6DD,CAN7D,8BAShBG,QAAQ,CAACC,gBAAT,CAA0BC,UAAUC,gBAApC,EACKC,OADL,CACa,SAACC,CAAD,CAAa,CAClBA,CAAO,CAACC,kBAAR,CAA2B,aAA3B,CAA0CP,CAA1C,CACH,CAHL,EAKAC,QAAQ,CAACC,gBAAT,CAA0BC,UAAUK,eAApC,EACKH,OADL,CACa,SAACI,CAAD,CAAS,CACd,GAAMC,CAAAA,CAAU,CAAG,GAAIC,UAAJ,CAAYF,CAAZ,CAAnB,CAEAA,CAAG,CAACG,gBAAJ,CAAqB,YAArB,CAAmC,UAAM,CAIrCF,CAAU,CAACG,IAAX,EACH,CALD,CAMH,CAVL,EAYMC,CA1BU,CA0BI,GAAIC,UAAJ,CAAcZ,UAAUK,eAAxB,CAAyC,CACzDQ,MAAM,CAAE,gBAACC,CAAD,CAAa,CACjB,MAAOA,CAAAA,CAAO,CAACC,UAAR,CAAmBC,kBAC7B,CAHwD,CAAzC,CA1BJ,CAgChBL,CAAW,CAACM,EAAZ,CAAe,SAAf,CAA0B,SAACC,CAAD,CAAO,CAC7B,GAAMX,CAAAA,CAAU,CAAG,GAAIC,UAAJ,CAAYU,CAAC,CAACJ,OAAd,CAAnB,CACAI,CAAC,CAACJ,OAAF,CAAUK,YAAV,CAAuB,qBAAvB,CAA8CzB,CAA9C,EACAa,CAAU,CAACa,IAAX,GACAC,UAAU,CAAC,UAAM,CACbd,CAAU,CAACe,OAAX,EACH,CAFS,CAEP,GAFO,CAAV,CAIAJ,CAAC,CAACJ,OAAF,CAAUK,YAAV,CAAuB,qBAAvB,CAA8CvB,CAA9C,EACAsB,CAAC,CAACK,cAAF,EACH,CAVD,EAhCgB,yCAAH,uDAAV,C","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Interface to using clipboard.js\n *\n * @module     tool_componentlibrary/clipboardwrapper\n * @package    tool_componentlibrary\n * @copyright  2021 Bas Brands <bas@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Tooltip from 'theme_boost/bootstrap/tooltip';\nimport Clipboard from 'tool_componentlibrary/clipboard';\nimport {get_string as getString} from 'core/str';\nimport selectors from 'tool_componentlibrary/selectors';\n\n/**\n * Initialise the clipboard button on all reusable code.\n */\nexport const init = async() => {\n    const copied = await getString('copied', 'tool_componentlibrary');\n    const copy = await getString('copy', 'tool_componentlibrary');\n    const copytoclipboard = await getString('copytoclipboard', 'tool_componentlibrary');\n\n    const btnHtml = `<div class=\"bd-clipboard\">\n        <button type=\"button\" class=\"btn-clipboard\" title=\"${copytoclipboard}\">${copy}</button>\n        </div>`;\n\n    document.querySelectorAll(selectors.clipboardcontent)\n        .forEach((element) => {\n            element.insertAdjacentHTML('beforebegin', btnHtml);\n        });\n\n    document.querySelectorAll(selectors.clipboardbutton)\n        .forEach((btn) => {\n            const tooltipBtn = new Tooltip(btn);\n\n            btn.addEventListener('mouseleave', () => {\n                // Explicitly hide tooltip, since after clicking it remains\n                // focused (as it's a button), so tooltip would otherwise\n                // remain visible until focus is moved away\n                tooltipBtn.hide();\n            });\n        });\n\n    const clClipboard = new Clipboard(selectors.clipboardbutton, {\n        target: (trigger) => {\n            return trigger.parentNode.nextElementSibling;\n        }\n    });\n\n    clClipboard.on('success', (e) => {\n        const tooltipBtn = new Tooltip(e.trigger);\n        e.trigger.setAttribute('data-original-title', copied);\n        tooltipBtn.show();\n        setTimeout(() => {\n            tooltipBtn.dispose();\n        }, 3000);\n\n        e.trigger.setAttribute('data-original-title', copytoclipboard);\n        e.clearSelection();\n    });\n};\n"],"file":"clipboardwrapper.min.js"}