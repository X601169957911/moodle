{"version":3,"sources":["../src/edit_switch.js"],"names":["changeEditmode","args","promise","Ajax","call","methodname","fail","Notification","exception","toggleEditSwitch","editSwitch","checked","setAttribute","window","location","dataset","pageurl","init","document","getElementById","addEventListener","setmode","context","then","result","success","dispatchEvent","CustomEvent","bubbles","catch"],"mappings":"6IAuBA,uD,GAQMA,CAAAA,CAAc,CAAG,SAAAC,CAAI,CAAI,IAMrBC,CAAAA,CAAO,CAAGC,UAAKC,IAAL,CAAU,CALV,CACZC,UAAU,CAAE,sBADA,CAEZJ,IAAI,CAAEA,CAFM,CAKU,CAAV,EAAqB,CAArB,EACXK,IADW,CACNC,YAAY,CAACC,SADP,CANW,CAS3B,MAAON,CAAAA,CACV,C,CAOKO,CAAgB,CAAG,SAAAC,CAAU,CAAI,CACnC,GAAIA,CAAU,CAACC,OAAf,CAAwB,CACpBD,CAAU,CAACE,YAAX,CAAwB,cAAxB,IACH,CAFD,IAEO,CACHF,CAAU,CAACE,YAAX,CAAwB,cAAxB,IACH,CAEDC,MAAM,CAACC,QAAP,CAAkBJ,CAAU,CAACK,OAAX,CAAmBC,OACxC,C,QAKmB,QAAPC,CAAAA,IAAO,EAAM,CACtB,GAAMP,CAAAA,CAAU,CAAGQ,QAAQ,CAACC,cAAT,CAAwB,eAAxB,CAAnB,CACAT,CAAU,CAACU,gBAAX,CAA4B,QAA5B,CAAsC,UAAW,CAC7CpB,CAAc,CACV,CACIqB,OAAO,CAAEX,CAAU,CAACC,OADxB,CAEIW,OAAO,CAAEZ,CAAU,CAACK,OAAX,CAAmBO,OAFhC,CADU,CAAd,CAKEC,IALF,CAKO,SAAAC,CAAM,CAAI,CACb,GAAIA,CAAM,CAACC,OAAX,CAAoB,CAChBhB,CAAgB,CAACC,CAAD,CAAhB,CACAA,CAAU,CAACgB,aAAX,CAAyB,GAAIC,CAAAA,WAAJ,CAAgB,kBAAhB,CACrB,CAACC,OAAO,GAAR,CAAgBP,OAAO,CAAEX,CAAU,CAACC,OAApC,CADqB,CAAzB,CAEH,CAJD,IAIO,CACHD,CAAU,CAACC,OAAX,GACH,CACD,MAAO,KACV,CAdD,EAcGkB,KAdH,CAcStB,YAAY,CAACC,SAdtB,CAeH,CAhBD,CAiBH,C","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Controls the drawer.\n *\n * @module     core/edit_switch\n * @copyright  2021 Bas Brands <bas@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Ajax from 'core/ajax';\n\n/**\n * Change the Edit mode.\n *\n * @param {Object} args The request arguments\n * @return {Promise} Resolved with an array file the stored file url.\n */\nconst changeEditmode = args => {\n    const request = {\n        methodname: 'core_change_editmode',\n        args: args\n    };\n\n    const promise = Ajax.call([request])[0]\n        .fail(Notification.exception);\n\n    return promise;\n};\n\n/**\n * Toggle the edit switch\n *\n * @param {Object} editSwitch DOMElement edit switch.\n */\nconst toggleEditSwitch = editSwitch => {\n    if (editSwitch.checked) {\n        editSwitch.setAttribute('aria-checked', true);\n    } else {\n        editSwitch.setAttribute('aria-checked', false);\n    }\n\n    window.location = editSwitch.dataset.pageurl;\n};\n\n/**\n * Add the eventlistener for the editswitch.\n */\nexport const init = () => {\n    const editSwitch = document.getElementById('editingswitch');\n    editSwitch.addEventListener('change', function() {\n        changeEditmode(\n            {\n                setmode: editSwitch.checked,\n                context: editSwitch.dataset.context\n            }\n        ).then(result => {\n            if (result.success) {\n                toggleEditSwitch(editSwitch);\n                editSwitch.dispatchEvent(new CustomEvent('change-edit-mode',\n                    {bubbles: true, setmode: editSwitch.checked}));\n            } else {\n                editSwitch.checked = false;\n            }\n            return null;\n        }).catch(Notification.exception);\n    });\n};\n"],"file":"edit_switch.min.js"}