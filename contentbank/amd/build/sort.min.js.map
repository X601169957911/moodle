{"version":3,"sources":["../src/sort.js"],"names":["init","contentBank","document","querySelector","selectors","regions","contentbank","registerListenerEvents","fileArea","filearea","shownItems","querySelectorAll","elements","listitem","viewGrid","actions","viewgrid","viewList","viewlist","addEventListener","classList","remove","add","sortByName","sortname","ascending","updateSortButtons","updateSortOrder","sortByDate","sortdate","sortBySize","sortsize","sortByType","sorttype","sortButton","sortButtons","sortbutton","forEach","button","string","getAttribute","then","str","toLowerCase","title","setAttribute","contains","itemList","attribute","sortList","slice","call","sort","a","b","aa","bb","isNaN","parseInt","listItem","appendChild"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Content bank UI actions.\n *\n * @module     core_contentbank/sort\n * @package    core_contentbank\n * @copyright  2020 Bas Brands <bas@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport selectors from 'core_contentbank/selectors';\nimport {get_string as getString} from 'core/str';\n\n/**\n * Set up the contentbank views.\n *\n * @method init\n */\nexport const init = () => {\n    const contentBank = document.querySelector(selectors.regions.contentbank);\n\n    registerListenerEvents(contentBank);\n};\n\n\n/**\n * Register contentbank related event listeners.\n *\n * @method registerListenerEvents\n * @param {HTMLElement} contentBank The DOM node of the content bank\n */\nconst registerListenerEvents = (contentBank) => {\n\n    // The search.\n    const fileArea = document.querySelector(selectors.regions.filearea);\n    const shownItems = fileArea.querySelectorAll(selectors.elements.listitem);\n\n    // The view buttons.\n    const viewGrid = contentBank.querySelector(selectors.actions.viewgrid);\n    const viewList = contentBank.querySelector(selectors.actions.viewlist);\n\n    viewGrid.addEventListener('click', () => {\n        contentBank.classList.remove('view-list');\n        contentBank.classList.add('view-grid');\n        viewGrid.classList.add('active');\n        viewList.classList.remove('active');\n    });\n\n    viewList.addEventListener('click', () => {\n        contentBank.classList.remove('view-grid');\n        contentBank.classList.add('view-list');\n        viewList.classList.add('active');\n        viewGrid.classList.remove('active');\n    });\n\n    // Sort by file name alphabetical\n    const sortByName = contentBank.querySelector(selectors.actions.sortname);\n    sortByName.addEventListener('click', () => {\n        let ascending = updateSortButtons(contentBank, sortByName);\n        updateSortOrder(fileArea, shownItems, 'data-file', ascending);\n    });\n\n    // Sort by date.\n    const sortByDate = contentBank.querySelector(selectors.actions.sortdate);\n    sortByDate.addEventListener('click', () => {\n        let ascending = updateSortButtons(contentBank, sortByDate);\n        updateSortOrder(fileArea, shownItems, 'data-timemodified', ascending);\n    });\n\n    // Sort by size.\n    const sortBySize = contentBank.querySelector(selectors.actions.sortsize);\n    sortBySize.addEventListener('click', () => {\n        let ascending = updateSortButtons(contentBank, sortBySize);\n        updateSortOrder(fileArea, shownItems, 'data-bytes', ascending);\n    });\n\n    // Sort by type\n    const sortByType = contentBank.querySelector(selectors.actions.sorttype);\n    sortByType.addEventListener('click', () => {\n        let ascending = updateSortButtons(contentBank, sortByType);\n        updateSortOrder(fileArea, shownItems, 'data-bytes', ascending);\n    });\n};\n\n/**\n * Update the sort button view.\n *\n * @method updateSortButtons\n * @param {HTMLElement} sortButton The DOM node of the sort button\n * @return {Bool} sort ascending\n */\nconst updateSortButtons = (contentBank, sortButton) => {\n    const sortButtons = contentBank.querySelectorAll(selectors.elements.sortbutton);\n\n    sortButtons.forEach((button) => {\n        if (button !== sortButton) {\n            button.classList.remove('dir-asc');\n            button.classList.remove('dir-desc');\n            let string = button.getAttribute('data-string');\n            getString(string, 'contentbank').then((str) => {\n                getString('sortbyx', 'core', str.toLowerCase()).then((title) => {\n                    button.setAttribute('title', title);\n                });\n            });\n        }\n    });\n\n    let ascending = true;\n\n    if (sortButton.classList.contains('dir-none')) {\n        sortButton.classList.remove('dir-none');\n        sortButton.classList.add('dir-asc');\n    } else if (sortButton.classList.contains('dir-asc')) {\n        sortButton.classList.remove('dir-asc');\n        sortButton.classList.add('dir-desc');\n        ascending = false;\n    } else if (sortButton.classList.contains('dir-desc')) {\n        sortButton.classList.remove('dir-desc');\n        sortButton.classList.add('dir-asc');\n        ascending = true;\n    }\n\n    let string = sortButton.getAttribute('data-string');\n    if (ascending) {\n        getString(string, 'contentbank').then((str) => {\n            getString('sortbyxreverse', 'core', str.toLowerCase()).then((title) => {\n                sortButton.setAttribute('title', title);\n            });\n        });\n    } else {\n        getString(string, 'contentbank').then((str) => {\n            getString('sortbyx', 'core', str.toLowerCase()).then((title) => {\n                sortButton.setAttribute('title', title);\n            });\n        });\n    }\n    return ascending;\n};\n\n/**\n * Update the sort order of the itemlist and update the DOM\n *\n * @method updateSortOrder\n * @param {HTMLElement} fileArea the Dom container for the itemlist\n * @param {Array} itemList Nodelist of Dom elements\n * @param {String} attribute, the attribut to sort on\n * @param {Bool} Sort Ascending\n */\nconst updateSortOrder = (fileArea, itemList, attribute, ascending) => {\n    let sortList = [].slice.call(itemList).sort(function (a, b) {\n        let aa = '';\n        let bb = '';\n        if (isNaN(a.getAttribute(attribute))) {\n            aa = a.getAttribute(attribute);\n        } else {\n            aa = parseInt(a.getAttribute(attribute));\n        }\n        if (isNaN(b.getAttribute(attribute))) {\n            bb = b.getAttribute(attribute);\n        } else {\n            bb = parseInt(b.getAttribute(attribute));\n        }\n        if (ascending) {\n            return aa > bb ? 1 : -1;\n        } else {\n            return aa < bb ? 1 : -1;\n        }\n    });\n    sortList.forEach(function (listItem) {\n        fileArea.appendChild(listItem);\n    });\n};"],"file":"sort.min.js"}