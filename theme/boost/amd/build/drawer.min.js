define(["jquery","core/custom_interaction_events","core/log"],function(d,a,e){var t='[data-region="drawer-toggle"]',l='[data-action="toggle-drawer"]',c="body",r=function(){d(t).length||e.debug("Page is missing a drawer region"),d(l).length||e.debug("Page is missing a drawer toggle link"),d(t).each(function(e,t){var a=d(t).find(l),r=a.attr("aria-controls"),n=d(document.getElementById(r)),i="false"==a.attr("aria-expanded"),o=a.attr("data-side"),s=d(c);n.on("mousewheel DOMMouseScroll",this.preventPageScroll),i?a.attr("aria-expanded","false"):(s.addClass("drawer-open-"+o),a.attr("aria-expanded","true"))}.bind(this)),this.registerEventListeners(),d(document).width()<768&&this.closeAll()};return r.prototype.closeAll=function(){d(t).each(function(e,t){var a=d(t).find(l),r=a.attr("data-side"),n=d(c),i=a.attr("aria-controls"),o=d(document.getElementById(i)),s=a.attr("data-preference");a.attr("aria-expanded","false"),n.removeClass("drawer-open-"+r),o.attr("aria-hidden","true"),o.addClass("closed"),M.util.set_user_preference(s,"false")})},r.prototype.toggleDrawer=function(e){var t=d(e.target).closest("[data-action=toggle-drawer]"),a=t.attr("aria-controls"),r=d(document.getElementById(a)),n=d(c),i=t.attr("data-side"),o=t.attr("data-preference");(n.addClass("drawer-ease"),"true"==t.attr("aria-expanded"))?(n.removeClass("drawer-open-"+i),t.attr("aria-expanded","false"),r.attr("aria-hidden","true"),r.addClass("closed"),M.util.set_user_preference(o,"false")):(d(document).width()<768&&this.closeAll(),t.attr("aria-expanded","true"),r.attr("aria-hidden","false"),r.focus(),n.addClass("drawer-open-"+i),r.removeClass("closed"),M.util.set_user_preference(o,"true"))},r.prototype.preventPageScroll=function(e){var t=e.wheelDelta||e.originalEvent&&e.originalEvent.wheelDelta||-e.originalEvent.detail,a=0<=this.scrollTop+d(this).outerHeight()-this.scrollHeight,r=this.scrollTop<=0;(t<0&&a||0<t&&r)&&e.preventDefault()},r.prototype.registerEventListeners=function(){d(l).each(function(e,t){a.define(d(t),[a.events.activate]),d(t).on(a.events.activate,function(e,t){this.toggleDrawer(t.originalEvent),t.originalEvent.preventDefault()}.bind(this))}.bind(this))},{init:function(){return new r}}});