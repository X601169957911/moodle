{"version":3,"sources":["../src/primarynav.js"],"names":["backdropPromise","getBackdrop","Templates","render","then","html","ModalBackdrop","fail","Notification","exception","sel","ids","togglebutton","pagecontent","closebutton","classes","dropdown","regions","languagemenu","languagemenucopy","usermenu","usermenucopy","primarynav","closeNav","primaryNav","document","querySelector","pageContent","backdrop","hide","style","overflow","showNav","primaryNavMenu","userMenuCopy","languageMenuCopy","userMenu","userContent","innerHTML","content","name","container","createElement","setAttribute","querySelectorAll","forEach","item","classList","add","appendChild","languageMenu","langContent","setZIndex","show","togglenavigation","toggleButton","closeButton","addEventListener","window","outerWidth"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Toggling the visibility of the primary navigation on mobile.\n *\n * @package    theme_boost\n * @copyright  2021 Bas Brands\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport {classUtil} from 'core/utils';\nimport ModalBackdrop from 'core/modal_backdrop';\nimport Templates from 'core/templates';\n\nlet backdropPromise = 0;\n\nconst getBackdrop = () => {\n    if (!backdropPromise) {\n        backdropPromise = Templates.render('core/modal_backdrop', {})\n            .then(function(html) {\n                return new ModalBackdrop(html);\n            })\n            .fail(Notification.exception);\n    }\n    return backdropPromise;\n};\n\nconst sel = {\n    ids: {\n        togglebutton: '#primarynavtoggle',\n        pagecontent: '#page-wrapper',\n        closebutton: '#primarynavclose'\n    },\n    classes: {\n        dropdown: '.dropdown-menu'\n    },\n    regions: {\n        languagemenu: '[data-region=\"languagemenu\"] .dropdown-menu',\n        languagemenucopy: '[data-region=\"languagemenucopy\"]',\n        usermenu: '[data-region=\"usermenu\"] .dropdown-menu',\n        usermenucopy: '[data-region=\"usermenucopy\"]',\n        primarynav: '[data-region=\"primarynavigation\"]'\n    }\n};\n\nconst closeNav = () => {\n    const primaryNav = document.querySelector(sel.regions.primarynav);\n    const pageContent = document.querySelector(sel.ids.pagecontent);\n\n    classUtil('remove', primaryNav, 'show');\n    getBackdrop().then(backdrop => {\n        backdrop.hide();\n        pageContent.style.overflow = 'auto';\n    });\n};\n\nconst showNav = () => {\n    const primaryNav = document.querySelector(sel.regions.primarynav);\n    const primaryNavMenu = primaryNav.querySelector('.navbar-nav');\n    const pageContent = document.querySelector(sel.ids.pagecontent);\n    const userMenuCopy = primaryNav.querySelector(sel.regions.usermenucopy);\n    const languageMenuCopy = primaryNav.querySelector(sel.regions.languagemenucopy);\n\n    // Move the usermenu content into the primary navigation\n    const userMenu = document.querySelector(sel.regions.usermenu);\n    if (userMenu && !userMenuCopy) {\n        const userContent = userMenu.innerHTML;\n        Templates.render('core/collapse', {content: userContent, name: 'My profile'})\n            .then(function(html) {\n                const container = document.createElement(\"li\");\n                container.setAttribute('data-region', 'usermenucopy');\n                container.innerHTML = html;\n                container.querySelectorAll('.dropdown-divider').forEach((item) => {\n                    item.classList.add('d-none');\n                });\n                container.querySelectorAll('.icon').forEach((item) => {\n                    item.classList.add('d-none');\n                });\n                container.querySelectorAll('.dropdown-item').forEach((item) => {\n                    classUtil('replace', item, 'dropdown-item', 'nav-link');\n                });\n                primaryNavMenu.appendChild(container);\n            })\n            .fail(Notification.exception);\n    }\n\n    // Move the languagemenu content into the primary navigation\n    const languageMenu = document.querySelector(sel.regions.languagemenu);\n    if (languageMenu && !languageMenuCopy) {\n        const langContent = languageMenu.innerHTML;\n        Templates.render('core/collapse', {content: langContent, name: 'Language'})\n            .then(function(html) {\n                const container = document.createElement(\"li\");\n                container.innerHTML = html;\n                container.setAttribute('data-region', 'languagemenucopy');\n                container.querySelectorAll('.dropdown-item').forEach((item) => {\n                    classUtil('replace', item, 'dropdown-item', 'nav-link');\n                });\n                primaryNavMenu.appendChild(container);\n            })\n            .fail(Notification.exception);\n    }\n\n\n    classUtil('add', primaryNav, 'show');\n    getBackdrop().then(backdrop => {\n        backdrop.setZIndex(1020);\n        backdrop.show();\n        pageContent.style.overflow = 'hidden';\n    });\n};\n\nexport const togglenavigation = () => {\n    const toggleButton = document.querySelector(sel.ids.togglebutton);\n    const closeButton = document.querySelector(sel.ids.closebutton);\n    const primarynav = document.querySelector(sel.regions.primarynav);\n\n    if (toggleButton && closeButton) {\n        toggleButton.addEventListener('click', () => {\n            if (classUtil('has', primarynav, 'show')) {\n                closeNav();\n            } else {\n                showNav();\n            }\n        });\n    }\n    if (closeButton) {\n        closeButton.addEventListener('click', () => {\n            closeNav();\n        });\n    }\n\n    window.addEventListener('resize', function () {\n        if (window.outerWidth > 992) {\n            closeNav();\n        }\n    });\n};\n"],"file":"primarynav.min.js"}