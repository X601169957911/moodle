{"version":3,"sources":["../src/drawer.js"],"names":["backdropPromise","Sizes","medium","pageWrapper","document","querySelector","getBackdrop","Templates","render","then","html","ModalBackdrop","fail","Notification","exception","closeNav","navRegion","closeBackdrop","isSmall","backdrop","hide","style","overflow","showNav","setZIndex","show","getRoot","addEventListener","region","getAttribute","dispatchEvent","CustomEvent","bubbles","detail","body","clientWidth","toggle","toggleButton","closeButton","e"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Toggling the visibility of the secondary navigation on mobile.\n *\n * @package    theme_boost\n * @copyright  2021 Bas Brands\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport {classUtil} from 'core/utils';\nimport ModalBackdrop from 'core/modal_backdrop';\nimport Templates from 'core/templates';\nimport Notification from 'core/notification';\n\nlet backdropPromise = null;\n/**\n * Simple object of sizes to respond to so we can easily modify as required.\n */\nconst Sizes = {\n    medium: 768\n};\n\nconst pageWrapper = document.querySelector('#page-wrapper');\n\nconst getBackdrop = () => {\n    if (!backdropPromise) {\n        // Would look to see if there is a way to migrate this to renderForPromise to remove the .then().\n        // Interesting idea to use some of the modal factory. Unsure if it is a good idea or\n        // if it should be more of a generic helper.\n        backdropPromise = Templates.render('core/modal_backdrop', {})\n            .then(html => {\n                return new ModalBackdrop(html);\n            })\n            .fail(Notification.exception);\n    }\n    return backdropPromise;\n};\n\nconst closeNav = (navRegion, closeBackdrop = true) => {\n\n    classUtil('remove', navRegion, 'show');\n\n    if (isSmall() && closeBackdrop) {\n        getBackdrop().then(backdrop => {\n            backdrop.hide();\n            pageWrapper.style.overflow = 'auto';\n        });\n    }\n};\n\nconst showNav = (navRegion) => {\n\n    classUtil('add', navRegion, 'show');\n\n    if (isSmall()) {\n        getBackdrop().then(backdrop => {\n            backdrop.setZIndex(1020);\n            backdrop.show();\n            pageWrapper.style.overflow = 'hidden';\n            backdrop.getRoot()[0].addEventListener('click', () => {\n                closeNav(navRegion);\n            });\n        });\n    }\n\n    const region = navRegion.getAttribute('data-region');\n    if (region) {\n        navRegion.dispatchEvent(new CustomEvent('show-boost-drawer', { bubbles: true, detail: region }));\n    }\n};\n\nconst isSmall = () => {\n    return document.body.clientWidth < Sizes.medium;\n};\n\nexport const region = (region, toggle) => {\n    const navRegion = document.querySelector(region);\n    const toggleButton = document.querySelector(toggle);\n\n    if (!navRegion) {\n        return '';\n    }\n\n    const closeButton = navRegion.querySelector('[data-action=\"closedrawer\"]');\n\n    toggleButton.addEventListener('click', () => {\n        if (classUtil('has', navRegion, 'show')) {\n            closeNav(navRegion);\n        } else {\n            showNav(navRegion);\n        }\n    });\n\n    if (closeButton) {\n        closeButton.addEventListener('click', () => {\n            closeNav(navRegion);\n        });\n    }\n\n    // Close drawer when another drawer opens.\n    document.addEventListener('show-boost-drawer', e => {\n        const region = navRegion.getAttribute('data-region');\n        if (region !== e.detail) {\n            closeNav(navRegion, false);\n        }\n    });\n\n};\n"],"file":"drawer.min.js"}